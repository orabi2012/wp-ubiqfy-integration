<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= title %>
    </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/css/common.css" rel="stylesheet">
    <link href="/css/navbar.css" rel="stylesheet">
    <link href="/css/forms.css" rel="stylesheet">

</head>

<body class="form-page-body">
    <% const pageTitle="Add Store" %>
        <%- include('../shared/navbar') %>

            <div class="container mt-4">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card form-card">
                            <div class="card-header bg-primary text-white">
                                <h4><i class="fas fa-plus"></i> Add New wp Store</h4>
                            </div>
                            <div class="card-body">
                                <!-- Error Messages -->
                                <% if (typeof error !=='undefined' && error) { %>
                                    <div class="alert alert-danger">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <%= error %>
                                    </div>
                                    <% } %>

                                        <!-- Success Messages -->
                                        <% if (typeof success !=='undefined' && success) { %>
                                            <div class="alert alert-success">
                                                <i class="fas fa-check-circle"></i>
                                                <%= success %>
                                            </div>
                                            <% } %>

                                                <form method="POST" action="/clients/add">
                                                    <div class="row">
                                                        <div class="col-md-6 mb-3">
                                                            <label for="wp_store_id" class="form-label">wp Store
                                                                ID
                                                                *</label>
                                                            <input type="text" class="form-control" id="wp_store_id"
                                                                name="wp_store_id" required>
                                                        </div>
                                                        <div class="col-md-6 mb-3">
                                                            <label for="wp_store_name" class="form-label">Store Name
                                                                *</label>
                                                            <input type="text" class="form-control"
                                                                id="wp_store_name" name="wp_store_name" required>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-6 mb-3">
                                                            <label for="wp_owner_name" class="form-label">Owner Name
                                                                *</label>
                                                            <input type="text" class="form-control"
                                                                id="wp_owner_name" name="wp_owner_name" required>
                                                        </div>
                                                        <div class="col-md-6 mb-3">
                                                            <label for="wp_owner_email" class="form-label">Owner
                                                                Email
                                                                *</label>
                                                            <input type="email" class="form-control"
                                                                id="wp_owner_email" name="wp_owner_email"
                                                                required>
                                                        </div>
                                                    </div>

                                                    <div class="alert alert-info">
                                                        <i class="fas fa-info-circle"></i>
                                                        <strong>Authentication:</strong> After creating the store, use
                                                        the OAuth
                                                        flow to authorize and get tokens automatically. Manual token
                                                        entry is no
                                                        longer required.
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-6 mb-3">
                                                            <label for="wp_currency" class="form-label">Store
                                                                Currency <small class="text-muted">(Will be
                                                                    auto-detected)</small></label>
                                                            <select class="form-control" id="wp_currency"
                                                                name="wp_currency">
                                                                <option value="SAR">SAR - Saudi Riyal</option>
                                                                <option value="USD">USD - US Dollar</option>
                                                                <option value="EUR">EUR - Euro</option>
                                                                <option value="AED">AED - UAE Dirham</option>
                                                            </select>
                                                            <small class="form-text text-muted">This will be updated
                                                                automatically from wp after connection.</small>
                                                        </div>
                                                        <div class="col-md-6 mb-3">
                                                            <label for="currency_conversion_rate"
                                                                class="form-label">Currency
                                                                Conversion Rate <small class="text-muted">(1 USD = ?
                                                                    Store
                                                                    Currency)</small></label>
                                                            <div class="input-group">
                                                                <span class="input-group-text">1 USD =</span>
                                                                <input type="number" class="form-control"
                                                                    id="currency_conversion_rate"
                                                                    name="currency_conversion_rate" value="3.7500"
                                                                    step="0.0001" min="0.0001" max="999999" required>
                                                                <span class="input-group-text">Store Currency</span>
                                                            </div>
                                                            <small class="form-text text-muted">Set the exchange rate
                                                                from USD
                                                                (Ubiqfy prices) to your store currency. Default: 1 USD =
                                                                3.75
                                                                SAR</small>
                                                        </div>
                                                    </div>

                                                    <h5 class="mt-4 mb-3"><i class="fas fa-shield-alt"></i> Ubiqfy API
                                                        Credentials</h5>
                                                    <div class="row">
                                                        <div class="col-md-4 mb-3">
                                                            <label for="ubiqfy_username" class="form-label">Username
                                                                *</label>
                                                            <input type="text" class="form-control" id="ubiqfy_username"
                                                                name="ubiqfy_username" required>
                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="ubiqfy_password" class="form-label">Password
                                                                *</label>
                                                            <input type="password" class="form-control"
                                                                id="ubiqfy_password" name="ubiqfy_password" required>
                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="ubiqfy_terminal_key" class="form-label">Terminal
                                                                Key
                                                                *</label>
                                                            <input type="text" class="form-control"
                                                                id="ubiqfy_terminal_key" name="ubiqfy_terminal_key"
                                                                required>
                                                        </div>
                                                    </div>

                                                    <div class="row">
                                                        <div class="col-md-6 mb-3">
                                                            <label for="ubiqfy_producttypecode"
                                                                class="form-label">Product Type
                                                                Code</label>
                                                            <input type="text" class="form-control"
                                                                id="ubiqfy_producttypecode"
                                                                name="ubiqfy_producttypecode" value="Voucher"
                                                                placeholder="e.g., DIGITAL, PHYSICAL, SERVICE, Voucher">
                                                            <div class="form-text">
                                                                <small class="text-muted">Product type code for Ubiqfy
                                                                    transactions</small>
                                                            </div>
                                                        </div>
                                                        <div class="col-md-6 mb-3">
                                                            <label for="sku_prefix" class="form-label">
                                                                <i class="fas fa-tag"></i> SKU Prefix
                                                            </label>
                                                            <input type="text" class="form-control" id="sku_prefix"
                                                                name="sku_prefix" value="UBQ"
                                                                placeholder="e.g., UBQ, UBIQFY, STORE" maxlength="10">
                                                            <div class="form-text">
                                                                <small class="text-muted">Prefix added to product SKUs
                                                                    to
                                                                    identify Ubiqfy products (e.g.,
                                                                    UBQ-PRODUCT123)</small>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <h5 class="mt-4 mb-3"><i class="fas fa-cog"></i> Configuration</h5>
                                                    <div class="row">
                                                        <div class="col-md-4 mb-3">
                                                            <div class="d-flex align-items-center">
                                                                <label class="toggle-switch">
                                                                    <input type="checkbox" id="ubiqfy_sandbox"
                                                                        name="ubiqfy_sandbox" value="true" checked>
                                                                    <span class="slider"></span>
                                                                </label>
                                                                <span class="toggle-label">Use Sandbox
                                                                    Environment</span>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="d-flex justify-content-between">
                                                        <% if (user.isSuperadmin) { %>
                                                            <a href="/admin/dashboard" class="btn btn-secondary">
                                                                <i class="fas fa-arrow-left"></i> Back to Dashboard
                                                            </a>
                                                            <% } else { %>
                                                                <div></div> <!-- Spacer for non-superadmin users -->
                                                                <% } %>
                                                                    <button type="submit" class="btn btn-success">
                                                                        <i class="fas fa-save"></i> Save Store
                                                                    </button>
                                                    </div>
                                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
            <script src="/js/bootstrap-init.js"></script>
</body>

</html>